"use strict";(self.webpackChunkng_matero=self.webpackChunkng_matero||[]).push([[686],{7686:(I,A,i)=>{i.r(A),i.d(A,{PermissionsModule:()=>a});var f=i(2233),T=i(9132),x=i(7579),Z=i(2722),e=i(4650),r=i(4954),d=i(4006),h=i(811),_=i(2802),P=i(6895);class m{constructor(s,o){this.rolesSrv=s,this.permissionsSrv=o,this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]},this._destroy$=new x.x}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),this.rolesSrv.roles$.pipe((0,Z.R)(this._destroy$)).subscribe(s=>{console.log(s)}),this.permissionsSrv.permissions$.pipe((0,Z.R)(this._destroy$)).subscribe(s=>{console.log(s)})}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions)}}m.\u0275fac=function(s){return new(s||m)(e.Y36(r.cM),e.Y36(r.YI))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-permissions-role-switching"]],decls:24,vars:7,consts:[["href","https://github.com/AlexKhymenko/ngx-permissions","target","_blank"],[3,"ngModel","ngModelChange","change"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(s,o){1&s&&(e._UZ(0,"page-header"),e.TgZ(1,"p"),e._uU(2," The permissions management is powered by "),e.TgZ(3,"a",0)(4,"code"),e._uU(5,"ngx-permissions"),e.qZA()(),e._uU(6,".\n"),e.qZA(),e.TgZ(7,"mat-button-toggle-group",1),e.NdJ("ngModelChange",function(p){return o.currentRole=p})("change",function(){return o.onPermissionChange()}),e.TgZ(8,"mat-button-toggle",2),e._uU(9,"ADMIN"),e.qZA(),e.TgZ(10,"mat-button-toggle",3),e._uU(11,"MANAGER"),e.qZA(),e.TgZ(12,"mat-button-toggle",4),e._uU(13,"GUEST"),e.qZA()(),e.TgZ(14,"p"),e._uU(15," Your current role: "),e.TgZ(16,"code"),e._uU(17),e.ALo(18,"json"),e.qZA()(),e.TgZ(19,"p"),e._uU(20," Your current permissions: "),e.TgZ(21,"code"),e._uU(22),e.ALo(23,"json"),e.qZA()()),2&s&&(e.xp6(7),e.Q6J("ngModel",o.currentRole),e.xp6(10),e.Oqu(e.lcZ(18,3,o.currentRole)),e.xp6(5),e.Oqu(e.lcZ(23,5,o.currentPermissions)))},dependencies:[d.JJ,d.On,h.A9,h.Yi,_.q,P.Ts]});class c{constructor(s,o,t){this.rolesSrv=s,this.permissionsSrv=o,this.router=t,this.permissionsOfRole={ADMIN:["canAdd","canDelete","canEdit","canRead"],MANAGER:["canAdd","canEdit","canRead"],GUEST:["canRead"]}}ngOnInit(){this.currentRole=Object.keys(this.rolesSrv.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions())}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesSrv.flushRolesAndPermissions(),this.rolesSrv.addRoleWithPermissions(this.currentRole,this.currentPermissions),this.router.navigateByUrl("/dashboard")}}c.\u0275fac=function(s){return new(s||c)(e.Y36(r.cM),e.Y36(r.YI),e.Y36(T.F0))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-permissions-route-guard"]],decls:20,vars:7,consts:[[3,"ngModel","ngModelChange","change"],["value","ADMIN"],["value","MANAGER"],["value","GUEST"]],template:function(s,o){1&s&&(e._UZ(0,"page-header"),e.TgZ(1,"p"),e._uU(2," The route will be redirected to dashboard after change permission.\n"),e.qZA(),e.TgZ(3,"mat-button-toggle-group",0),e.NdJ("ngModelChange",function(p){return o.currentRole=p})("change",function(){return o.onPermissionChange()}),e.TgZ(4,"mat-button-toggle",1),e._uU(5,"ADMIN"),e.qZA(),e.TgZ(6,"mat-button-toggle",2),e._uU(7,"MANAGER"),e.qZA(),e.TgZ(8,"mat-button-toggle",3),e._uU(9,"GUEST"),e.qZA()(),e.TgZ(10,"p"),e._uU(11," Your current role: "),e.TgZ(12,"code"),e._uU(13),e.ALo(14,"json"),e.qZA()(),e.TgZ(15,"p"),e._uU(16," Your current permissions: "),e.TgZ(17,"code"),e._uU(18),e.ALo(19,"json"),e.qZA()()),2&s&&(e.xp6(3),e.Q6J("ngModel",o.currentRole),e.xp6(10),e.Oqu(e.lcZ(14,3,o.currentRole)),e.xp6(5),e.Oqu(e.lcZ(19,5,o.currentPermissions)))},dependencies:[d.JJ,d.On,h.A9,h.Yi,_.q,P.Ts]});var U=i(4906);function v(n,s){1&n&&(e.TgZ(0,"p",11),e._uU(1," I should see it only admin "),e.qZA())}function C(n,s){1&n&&(e.TgZ(0,"p",11),e._uU(1," Usage on both only and except I should see it only admin "),e.qZA())}function b(n,s){1&n&&(e.TgZ(0,"p",12),e._uU(1,"I will see it only guest"),e.qZA())}function R(n,s){1&n&&(e.TgZ(0,"p",13),e._uU(1,"I will see it except adminnnnn"),e.qZA())}function y(n,s){1&n&&(e.TgZ(0,"p",14),e._uU(1,"I should see it except admin"),e.qZA())}function M(n,s){1&n&&(e.TgZ(0,"div"),e._uU(1," Testing template\n"),e.qZA())}function O(n,s){1&n&&(e.TgZ(0,"div"),e._uU(1," Testing template\n"),e.qZA())}function N(n,s){1&n&&(e.TgZ(0,"p",15),e._uU(1,"else block"),e.qZA())}function E(n,s){1&n&&(e.TgZ(0,"p",16),e._uU(1,"then block"),e.qZA())}function S(n,s){1&n&&(e.TgZ(0,"button"),e._uU(1," This should be visible to admin or superadmin "),e.qZA())}function q(n,s){1&n&&(e.TgZ(0,"button"),e._uU(1,"WTF"),e.qZA())}const g=function(){return["admin"]},Y=function(){return["guest"]},J=function(){return["adminnnnn"]},D=function(){return[]};class l{constructor(s){this.permissionsSrv=s,this.comparedPermission=["guest"]}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(){this.permissionsSrv.addPermission("admin",()=>new Promise((s,o)=>{setTimeout(()=>s(!0),2e3)}))}removePermission(){this.permissionsSrv.removePermission("admin")}unAuthorized(){console.log("unAuthorized")}authorized(){console.log("authorizes")}changeToAdmin(){this.comparedPermission=["admin"],console.log(this.comparedPermission)}changeToAnotherPermission(){this.comparedPermission=["awesome"],console.log(this.comparedPermission)}changeToGuest(){this.comparedPermission=["guest"],console.log(this.comparedPermission)}}l.\u0275fac=function(s){return new(s||l)(e.Y36(r.YI))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-permissions-test"]],decls:39,vars:28,consts:[["type","danger"],[3,"click"],["permissions","",3,"ngxPermissionsOnly"],[3,"ngxPermissionsOnly","ngxPermissionsExcept"],["permissions","",3,"ngxPermissionsExcept","permissionsAuthorized","permissionsUnauthorized"],["permissions","",3,"ngxPermissionsExcept"],[4,"ngxPermissionsOnly","ngxPermissionsOnlyElse","ngxPermissionsOnlyThen"],[4,"ngxPermissionsExcept","ngxPermissionsExceptElse","ngxPermissionsExceptThen"],["a",""],["b",""],[4,"ngxPermissionsOnly"],[1,"bg-green-500","text-white"],[1,"bg-purple-500","text-white"],[1,"bg-orange-500","text-white"],[1,"bg-indigo-500","text-white"],[1,"bg-gray-900","text-white"],[1,"bg-gray-300"]],template:function(s,o){if(1&s&&(e._UZ(0,"page-header"),e.TgZ(1,"mtx-alert",0),e._uU(2,"The permissions check will delay 2s."),e.qZA(),e.TgZ(3,"p")(4,"button",1),e.NdJ("click",function(){return o.addPermission()}),e._uU(5,"Add Permission [ admin ]"),e.qZA(),e.TgZ(6,"button",1),e.NdJ("click",function(){return o.removePermission()}),e._uU(7,"Remove Permission [ admin ]"),e.qZA()(),e.YNc(8,v,2,0,"ng-template",2),e.YNc(9,C,2,0,"ng-template",3),e.YNc(10,b,2,0,"ng-template",2),e.YNc(11,R,2,0,"ng-template",4),e.NdJ("permissionsAuthorized",function(){return o.authorized()})("permissionsUnauthorized",function(){return o.unAuthorized()}),e.YNc(12,y,2,0,"ng-template",5),e.YNc(13,M,2,0,"div",6),e.YNc(14,O,2,0,"div",7),e.YNc(15,N,2,0,"ng-template",null,8,e.W1O),e.YNc(17,E,2,0,"ng-template",null,9,e.W1O),e.TgZ(19,"p"),e._uU(20," Compared permission: "),e.TgZ(21,"code"),e._uU(22),e.ALo(23,"json"),e.qZA()(),e.TgZ(24,"div")(25,"button",1),e.NdJ("click",function(){return o.changeToAdmin()}),e._uU(26,"Change To Admin Permission"),e.qZA(),e.TgZ(27,"button",1),e.NdJ("click",function(){return o.changeToAnotherPermission()}),e._uU(28,"Change To Awesome Permission"),e.qZA(),e.TgZ(29,"button",1),e.NdJ("click",function(){return o.changeToGuest()}),e._uU(30,"Change To Guest Permission"),e.qZA()(),e.TgZ(31,"div"),e.YNc(32,S,2,0,"button",10),e.YNc(33,q,2,0,"button",10),e.qZA(),e.TgZ(34,"p"),e._uU(35," Your current permissions: "),e.TgZ(36,"code"),e._uU(37),e.ALo(38,"json"),e.qZA()()),2&s){const t=e.MAs(16),p=e.MAs(18);e.xp6(8),e.Q6J("ngxPermissionsOnly",e.DdM(20,g)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(21,g))("ngxPermissionsExcept","hhhhh"),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(22,Y)),e.xp6(1),e.Q6J("ngxPermissionsExcept",e.DdM(23,J)),e.xp6(1),e.Q6J("ngxPermissionsExcept",e.DdM(24,g)),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(25,g))("ngxPermissionsOnlyElse",t)("ngxPermissionsOnlyThen",p),e.xp6(1),e.Q6J("ngxPermissionsExcept",e.DdM(26,g))("ngxPermissionsExceptElse",t)("ngxPermissionsExceptThen",p),e.xp6(8),e.Oqu(e.lcZ(23,16,o.comparedPermission)),e.xp6(10),e.Q6J("ngxPermissionsOnly",o.comparedPermission),e.xp6(1),e.Q6J("ngxPermissionsOnly",e.DdM(27,D)),e.xp6(4),e.Oqu(e.lcZ(38,18,o.getPermissions()))}},dependencies:[U.P,r.gE,_.q,P.Ts]});const G=[{path:"role-switching",component:m},{path:"route-guard",component:c,canActivate:[r.DD],data:{permissions:{except:"GUEST",redirectTo:"/dashboard"}}},{path:"test",component:l,canActivate:[r.DD],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];class u{}u.\u0275fac=function(s){return new(s||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[T.Bz.forChild(G),T.Bz]});class a{}a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.m,u]})}}]);